**RU** | [EN](README.md)

# Предсказание температуры стали

- [Посмотреть Jupyter-блокнот](steel_temperature_prediction_ru.ipynb)

Стэк: `keras`, `tensorflow`, `catboost`, `optuna`, `sklearn`, `sqlalchemy`, `matplotlib`, `seaborn`, `pandas`, `numpy`, `dotenv`

## Описание

Чтобы оптимизировать производственные расходы, металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава. Ваша задача — построить модель, которая будет её предсказывать. Заказчик хочет использовать разработанную модель для имитации технологического процесса. Изучите его, прежде чем генерировать новые признаки.

## Выводы

- Металлургическому комбинату понадобилось предсказывать измеряемую температуру стали для снижения потребления электроэнергии на этапе обработки стали

- Было получено 7 таблиц данных по процессам обработки стали
- Обработаны пропуски, аномалии, дубликаты
- 2 таблицы отброшены при дальнейшей работе: `df_bulk_time`, `df_wire_time`
- Столбцы с большим количеством пустых значений были удалены
- Добавлены новые признаки
- Таблицы имели разный размер
  - `df_wire`, `df_bulk`, `df_gas` уже соответствовали принципу "одно наблюдение одна партия стали"
  - `df_temp`, `df_arc` были агрегированы что бы соответствовать принципу
- После сделано объединение всех таблиц в одну по номеру партии
- Изучены статистики данных и корреляции
- Количество итераций сильно коррелирует с полной мощностью

- Было обучено 5 моделей с метрикой **MAE** для регрессии по последней измеренной температуре стали на обучающей выборке:

- Для CatBoostRegressor был применён фреймворк Optuna для оптимизации гиперпараметров
- Лучшей моделью оказалась **CatBoostRegressor** с метрикой на тестовой выборке: 4.89
- Что соответствует условию задачи — **меньше 6.8**
- Продемонстрирована работа лучшей модели

- Сделано сравнение константной и лучшей модели с разницей **7.7918** на тестовой выборке
- Проанализирована важность признаков

- `temperature_first`, первая температура стали самый важный признак
- `measure_temp_duration`, далее длительность нагрева стали
- `full_power`, затем полная мощность
- `Wire 1`, и признак касающийся засыпки объёма проволочных материалов
- В связи с этими самыми важными признаками следует улучшать энергопотребление и рекомендации заказчику могут быть такими:
  - К моменту первого измерения температуры, она должна быть более походящей (видимо выше) и это сильнее всего отразится на дальнейших измерениях.
  - Возможно нужно сохранять температуру при заливе в ковш, например более закрытая среда или что то подобное.
  - Возможно дело в рабочем процессе рабочих, вроде смен или временных промежутках между операционными действиями.
  - Все остальные признаки могут быть следствием этого, так как это начало процесса.
  - Есть сильная корреляция этих признаков с количеством итераций цикла, если их уменьшить, уменьшиться и электропотребление. Возможно сталь в целом будет меньше остывать и требовать нагрева если её чуть сильнее нагревать на первых итерациях и в итоге не заводить на одну, две последние, или что то подобное.
- Модель можно улучшить путём улучшения точности и полноты данных, например в том числе работу датчиков. И более сложной обработкой признаков содержащих время