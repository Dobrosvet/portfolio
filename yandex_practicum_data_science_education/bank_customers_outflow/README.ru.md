**RU** | [EN](README.md)

# Отток клиентов банка

- [Посмотреть Jupyter-блокнот](bank_customers_outflow_ru.ipynb)

Стэк: `sklearn`, `matplotlib`, `seaborn`, `pandas`

## Описание

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

Постройте модель с предельно большим значением *F1*-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте *F1*-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте *AUC-ROC*, сравнивайте её значение с *F1*-мерой.

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

## Выводы

На парном графике прослеживается, что больше всего ушедших относятся к возрасту в районе 50 лет у них большое количество продуктов банка (3-4). Возможно такие клиенты лучше разбираются в продуктах и находят лучший вариант в другом банке. Возможно дело в 1-2 продуктов банка.

При прогнозировании классов в данных важно учитывать дисбаланс классов для улучшения прогнозов модели. Обе метрики F1 и ROC-AUC, показательны для проверки качества моделей и значительно улучшаются при учёте дисбаланса.

Лучше всего себя показала модель **случайного леса** с F1-мерой $60.4\%$ (в отличии от константной $0\%$), где данные "прямо кодированы" и использован аргумент `'class_weight'`. По метрике ROC-AUC эта модель на $(77.3\%-50\%)*2=54.6\%$ лучше константной.