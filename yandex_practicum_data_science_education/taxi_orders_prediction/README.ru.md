**RU** | [EN](README.md)

# Прогнозирование заказов такси

- [Посмотреть Jupyter-блокнот](taxi_orders_prediction_ru.ipynb)

Стэк: `xgboost`, `sklearn`, `statsmodels`, `pandas`, `matplotlib`

## Описание

Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Постройте модель для такого предсказания.

Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

Вам нужно:

1. Загрузить данные и выполнить их ресемплирование по одному часу.
2. Проанализировать данные.
3. Обучить разные модели с различными гиперпараметрами. Сделать тестовую выборку размером 10% от исходных данных.
4. Проверить данные на тестовой выборке и сделать выводы.

## Выводы

- Данные представлены в диапазоне с 2018-03-01 00:00:00 до 2018-08-31 23:00:00
- Тренд постоянно растёт с 10 до 30 заказов
- Период сезонности в данных — 24 часа. В 6:00 заказов меньше всего. В течении дня 3 пика по нарастающей количества заказов в 10:00, 16:00 и 00:00
- В среднем происходит 14 заказов в час с колебанием в 8 заказов
- Бывает что заказов нет совсем, а максимум было 77
- Среднее и стандартное отклонение временного ряда меняется со временем, значит ряд нестациоанрный

- Было рассмотрено 4 модели для предсказания временных рядов с перебором гиперпараметров: по предыдущему значению, по скользящему среднему, линейная регрессия и XGBoost
- Лучшая модель с метрикой **RMSE 9.2** на кросс валидации и **RMSE 45.8** на тестовой — XGBoost с подготовленными признаками с временным лагом в 24 часа и окном скользящего среднего в 24 часа и другими параметрами: 'colsample_bytree': 0.8, 'gamma': 0.5, 'max_depth': 5, 'min_child_weight': 5, 'subsample': 0.8